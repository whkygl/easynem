---
title: "easynem_manual"
author: "Wang Kunguang"
date: "2024-04-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## easynem introduction

This R package has a built-in Nemaplex database for nematodes, which can be used to search for various nematodes. At the same time, this R package supports various nematode communities and functional analyses such as nematode diversity, maturity index, metabolic footprint, and functional guild. This R package promises to be continuously updated, hoping to help relevant practitioners in a small way. For more details on using easynem see <https://github.com/whkygl/easynem>.

## Package installation and data reading

```{r}
devtools::install_github("whkygl/easynem")
library(easynem)
bac <- read_nem(tab = easynem_example("bacotu.csv"), tax = easynem_example("bactax.csv"), meta = easynem_example("meta.csv"))
meta <- read_nem(meta = easynem_example("meta.csv"))
```

## Database search

```{r}
# nem_database()
```

## trans_formula

The calculation of the meta was only applied to a single variable.

```{r}
hehe2 <- trans_formula(meta,pH,~1/x)
```

## trans_formula_v

The calculation of the meta was applied to vector.

```{r}
hehe3 <- trans_formula_v(meta,c("P", "K", "Ca"),~1/x)
```

## trans_name

Reaggregate tab by tax

```{r}
bac1 <- trans_name(bac, Class)
```

## trans_norm

Standardized tab

```{r}
hehe2 = trans_norm(data = bac, method = total)
colSums(hehe2@tab[,-1])
hehe2 = trans_norm(data = bac, method = percent)
colSums(hehe2@tab[,-1])
```

## trans_rare

The tab was randomly sampled

```{r}
hehe2 <- trans_rare(bac, 20000)
colSums(hehe2@tab[,-1])
hehe2 <- trans_rare(bac, 0)
colSums(hehe2@tab[,-1])
```

## filter_name

Filter meta, tax and tab

```{r}
hehe <- filter_name(bac, target = meta, season == "Spring")

```

```{r}
hehe <- filter_name(bac, target = tax, Phylum == "Actinobacteria")
```

```{r}
hehe <- filter_name(bac, target = tab, OTUID == "ASV_6941")
```

## filter_num

```{r}
hehe2 <- filter_num(bac, num = 100)
```

```{r}
hehe2 <- filter_num(bac, num = 0.9)
```

## calc_beta

```{r}
nmds = calc_beta(bac, nmds, con_crop, method = bray)
```

```{r}
p = nem_plot(nmds)
```

```{r}
p = nem_plot(nmds,level = 1)
```

```{r}
p = nem_plot(nmds,level = 0.6,type = 1)
```

```{r}
p = nem_plot(nmds,level = 0.6,type = 2)
```

## calc_beta2

```{r}
nmds = calc_beta2(bac, nmds, con_crop, season, method = bray)
```

```{r}
pcoa = calc_beta2(bac, pcoa, con_crop, season, method = bray)
```

