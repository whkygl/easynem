dev.tools::install_github("whkygl/easynem")
devtools::install_github("whkygl/easynem")
library(easynem)
hehe <- bac |> filter_name(meta, con_crop %in% c("Y2","Y11")) |> calc_compare2(.group1 = con_crop, .group2 = season, y = pH, method = TTest2)
bac <- read_nem(tab = easynem_example("bacotu.csv"),
tax = easynem_example("bactax.csv"),
meta = easynem_example("meta.csv"))
hehe <- bac |> filter_name(meta, con_crop %in% c("Y2","Y11")) |> calc_compare2(.group1 = con_crop, .group2 = season, y = pH, method = TTest2)
hehe
# devtools::install_github("whkygl/easynem")
library(easynem)
bac <- read_nem(tab = easynem_example("bacotu.csv"),
tax = easynem_example("bactax.csv"),
meta = easynem_example("meta.csv"))
hehe <- bac |> filter_name(meta, con_crop %in% c("Y2","Y11")) |> calc_compare2(.group1 = con_crop, .group2 = season, y = pH, method = TTest2)
hehe
object = hehe
# object = hehe
meta = object@meta
temp = object@temp
meta
temp
hehe@result
View(hehe)
class(hehe@result)
result = object@result
View(result)
library(ggplot2)
library(ggsignif)
# 创建示例数据
data <- data.frame(
group = rep(c("A", "B", "C"), each = 20),
subgroup = rep(c("X", "Y"), each = 10, times = 3),
value = c(rnorm(10, mean = 5), rnorm(10, mean = 6),
rnorm(10, mean = 6), rnorm(10, mean = 7),
rnorm(10, mean = 7), rnorm(10, mean = 8))
)
View(data)
# 绘制簇状箱线图
p <- ggplot(data, aes(x = interaction(group, subgroup), y = value, fill = subgroup)) +
geom_boxplot() +
labs(x = "Group", y = "Value", title = "Clustered Boxplot with Significance") +
theme_minimal()
p
# 添加显著性标记
p + geom_signif(
comparisons = list(c("A.X", "A.Y"), c("B.X", "B.Y"), c("C.X", "C.Y")),
map_signif_level = TRUE
)
meta
library(ggplot2)
# 创建示例数据框
data <- data.frame(
x = rnorm(100),
y = rnorm(100),
group = sample(c("A", "B"), 100, replace = TRUE)
)
data
# 使用aes_string传递字符型参数
ggplot(data, aes_string(x = "x", y = "y", color = "group")) +
geom_point()
# 使用aes_string传递字符型参数
ggplot(data, aes(x = !!sym("x"), y = !!sym("y"), color = !!sym("group")) +
# 使用aes_string传递字符型参数
ggplot(data, aes(x = !!sym("x"), y = !!sym("y"), color = !!sym("group"))) +
geom_point()
?sym
meta
names(meta)[2]
?geom_boxplot
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3])) +
ggplot2::geom_boxplot(position = "dodge", colour = "black")
} else if (type2 == 2){
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3])) +
ggplot2::geom_boxplot(position = "dodge", colour = "black")
} else if (type2 == 2){
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3])) +
ggplot2::geom_boxplot(position = "dodge", colour = "black")
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black")
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter()
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3]), shape = 21, width = 0.1))
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3]), shape = 21, width = 0.1))
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])), shape = 21, width = 0.1)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])), shape = 21)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(position = "dodge", aes(fill = !!rlang::sym(names(meta)[3])), shape = 21)
p
?position_jitter
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])), position = ggplot2::position_jitter(width = 0.1), shape = 21)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3]), position = "dodge"), shape = 21)
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])), position = "dodge", shape = 21)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])), position = position_dodge(width = 0.1), shape = 21)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])), position = position_jitter(width = 0.1), shape = 21)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])),shape = 21)
p
meta
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(Spring+Summer, pH, fill = !!rlang::sym(names(meta)[3])),shape = 21)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(Y11+Y2, pH, fill = !!rlang::sym(names(meta)[3])),shape = 21)
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(position = "dodge", colour = "black") + ggplot2::geom_jitter(aes(fill = !!rlang::sym(names(meta)[3])),shape = 21)
p
# 创建示例数据框
data <- data.frame(
group = rep(c("A", "B"), each = 50),
subgroup = rep(c("X", "Y"), times = 50),
value = c(rnorm(50, mean = 5), rnorm(50, mean = 7), rnorm(50, mean = 4), rnorm(50, mean = 6))
)
# 绘制箱线图并添加散点图
ggplot(data, aes(x = group, y = value, fill = subgroup)) +
geom_boxplot(position = position_dodge(width = 0.8), outlier.shape = NA) +
geom_jitter(position = position_dodge(width = 0.8), aes(color = subgroup), size = 1.5, alpha = 0.7) +
labs(title = "Boxplot with Jittered Points",
x = "Group",
y = "Value") +
theme_minimal()
# 加载ggplot2包
library(ggplot2)
# 创建示例数据框
data <- data.frame(
group = rep(c("A", "B"), each = 50),
subgroup = rep(c("X", "Y"), times = 50),
value = c(rnorm(50, mean = 5), rnorm(50, mean = 7), rnorm(50, mean = 4), rnorm(50, mean = 6))
)
# 绘制箱线图并添加抖动散点图
ggplot(data, aes(x = group, y = value, fill = subgroup)) +
geom_boxplot(position = position_dodge(width = 0.8), outlier.shape = NA) +
geom_jitter(position = position_dodge(width = 0.8), aes(color = subgroup), size = 1.5, alpha = 0.7, width = 0.2) +
labs(title = "Boxplot with Jittered Points",
x = "Group",
y = "Value") +
theme_minimal()
# 加载ggplot2包
library(ggplot2)
# 创建示例数据框
data <- data.frame(
group = rep(c("A", "B"), each = 50),
subgroup = rep(c("X", "Y"), times = 50),
value = c(rnorm(50, mean = 5), rnorm(50, mean = 7), rnorm(50, mean = 4), rnorm(50, mean = 6))
)
# 绘制箱线图并添加抖动散点图
ggplot(data, aes(x = group, y = value, fill = subgroup)) +
geom_boxplot(position = position_dodge(width = 0.8), outlier.shape = NA) +
geom_jitter(aes(color = subgroup), size = 1.5, alpha = 0.7, width = 0.2, position = position_dodge(width = 0.8)) +
labs(title = "Boxplot with Jittered Points",
x = "Group",
y = "Value") +
theme_minimal()
# 加载ggplot2包
library(ggplot2)
# 创建示例数据框
data <- data.frame(
group = rep(c("A", "B"), each = 50),
subgroup = rep(c("X", "Y"), times = 50),
value = c(rnorm(50, mean = 5), rnorm(50, mean = 7), rnorm(50, mean = 4), rnorm(50, mean = 6))
)
# 绘制箱线图并添加抖动散点图
ggplot(data, aes(x = group, y = value, fill = subgroup)) +
geom_boxplot(position = position_dodge(width = 0.8), outlier.shape = NA) +
geom_jitter(aes(color = subgroup), size = 1.5, alpha = 0.7, width = 0.2, position = position_dodge(width = 0.8)) +
labs(title = "Boxplot with Jittered Points",
x = "Group",
y = "Value") +
theme_minimal()
# 加载ggplot2包
library(ggplot2)
# 创建示例数据框
data <- data.frame(
group = rep(c("A", "B"), each = 50),
subgroup = rep(c("X", "Y"), times = 50),
value = c(rnorm(50, mean = 5), rnorm(50, mean = 7), rnorm(50, mean = 4), rnorm(50, mean = 6))
)
# 绘制箱线图并添加抖动散点图
ggplot(data, aes(x = group, y = value, fill = subgroup)) +
geom_boxplot(position = position_dodge2(width = 0.8), outlier.shape = NA) +
geom_point(aes(color = subgroup),
position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2),
size = 1.5, alpha = 0.7) +
labs(title = "Boxplot with Jittered Points",
x = "Group",
y = "Value") +
theme_minimal()
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), color = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(position = position_jitterdodge())
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(aes(color = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(position = position_jitterdodge())
p
bac <- read_nem(tab = easynem_example("bacotu.csv"),
tax = easynem_example("bactax.csv"),
meta = easynem_example("meta.csv"))
hehe <- bac |> calc_compare(con_crop, pH, method = LSD) |> nem_plot()
hehe
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(aes(color = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(position = position_jitterdodge())
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]))) +
ggplot2::geom_boxplot(aes(color = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(position = position_jitterdodge())
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(aes(color = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(position = position_jitterdodge())
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(position = position_jitterdodge())
p
meta
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge())
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge(),width = 0.1)
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge(width = 0.1))
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge(jitter.width = 0.5))
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge(jitter.width = 0.1))
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge(jitter.width = 1))
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge(jitter.width = 10))
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = position_jitterdodge(jitter.width = 0.1))
p
？position_jitterdodg
?position_jitterdodg
??position_jitterdodg\
??position_jitterdodg
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = ggplot2::position_jitterdodge())
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = ggplot2::position_jitterdodge())
p
meta
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = ggplot2::position_jitterdodge())
p
p = ggplot2::ggplot(meta, ggplot2::aes(x = !!rlang::sym(names(meta)[2]), y = !!rlang::sym(names(meta)[4]), fill = !!rlang::sym(names(meta)[3]))) +
ggplot2::geom_boxplot(ggplot2::aes(fill = !!rlang::sym(names(meta)[3]))) + ggplot2::geom_jitter(ggplot2::aes(fill = !!rlang::sym(names(meta)[3])), shape = 21,position = ggplot2::position_jitterdodge())
p
